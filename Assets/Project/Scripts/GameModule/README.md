# Game Module 文档

## 1. 模块结构

### 1.1 核心层 (Core)
- `GameManager.cs`
  - 功能：游戏系统总管理器
  - 职责：
    - 游戏流程控制
    - 游戏模式管理
    - 回合管理
    - 游戏进度追踪
    - 胜负条件判定

- `GameStateManager.cs`
  - 功能：游戏状态管理
  - 职责：
    - 状态转换控制
    - 热身阶段管理
    - 回合状态管理
    - 倒计时系统

- `MatchManager.cs`
  - 功能：匹配和队伍管理
  - 职责：
    - 玩家加入/离开管理
    - 队伍分配和平衡
    - 观战系统
    - 准备状态管理

- `ScoreManager.cs`
  - 功能：分数和统计系统
  - 职责：
    - 总分统计
    - 回合分数统计
    - 连杀系统
    - 排行榜管理

### 1.2 数据层 (Data)
- `GameConfig.cs`
  - 游戏配置数据
  - 包含：
    - StateConfig: 状态配置
    - MatchConfig: 匹配配置
    - ScoreConfig: 分数配置
    - RuleConfig: 规则配置
    - GameModeConfig: 游戏模式配置

- `GameState.cs`
  - 状态定义
  - 包含：
    - GameState: 游戏状态
    - GameMode: 游戏模式
    - GamePhase: 游戏阶段
    - RoundState: 回合状态

- `GameEvents.cs`
  - 事件定义
  - 类型：
    - 游戏核心事件
    - 玩家事件
    - 匹配事件
    - 分数事件
    - 回合事件
    - 游戏进度事件

## 2. 游戏流程

### 2.1 基本流程

## 3. 网络同步说明
所有需要同步的状态都使用 [Networked] 属性标记：
- IsGameStarted: 游戏是否开始
- IsGamePaused: 游戏是否暂停
- GameTime: 游戏时间

## 4. 主要功能
1. 游戏流程控制
   - 游戏开始/结束
   - 暂停/继续
   - 状态转换
   - 倒计时系统

2. 匹配系统
   - 玩家加入/离开管理
   - 准备状态管理
   - 匹配超时处理
   - 人数检查

3. 分数系统
   - 得分计算
   - 击杀统计
   - 生存时间奖励
   - 排行榜管理

4. 规则系统
   - 时间限制
   - 胜利条件判定
   - 玩家数量检查
   - 重生机制

## 5. 注意事项
1. 所有状态更新需要检查 StateAuthority
2. 事件系统用于模块间通信，所有事件定义统一在 GameEvents.cs 中
3. 配置值需要在 Inspector 中设置
4. 玩家生成需要地图模块配合
5. 分数系统会影响游戏结束判定 

None -> WaitingForPlayers -> Warmup -> Countdown -> RoundStarting -> Playing -> RoundEnding -> (循环) -> GameOver

### 2.2 游戏模式
1. Normal: 标准模式
2. Practice: 练习模式（无时间限制，可重生）
3. Tournament: 比赛模式（严格规则，不可中途加入）
4. Custom: 自定义模式

### 2.3 游戏阶段
1. Early: 游戏早期 (0-25%)
2. Mid: 游戏中期 (25-50%)
3. Late: 游戏后期 (50-75%)
4. Final: 最终阶段 (75-100%)，双倍积分



## 3. 特殊系统

### 3.1 连杀系统
- 三连杀：+50分
- 五连杀：+100分
- 七连杀：+200分
- 十连杀：+500分，超神

### 3.2 队伍系统
- 自动队伍平衡
- 队伍分数统计
- 团队胜利条件

### 3.3 观战系统
- 中途观战
- 观战者状态管理
- 观战目标切换

## 4. 注意事项
1. 所有状态更新需要检查 StateAuthority
2. 事件系统用于模块间通信
3. 分数系统支持回合独立统计
4. 游戏模式会影响规则配置
5. 回合系统包含延迟处理